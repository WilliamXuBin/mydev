function ajax_get_all_companys(){$.ajax({url:ajax_106+"/get_all_companys",type:"post",dataType:"json"}).then(function(e){if("0000"===e.code){var t=e.data;if(t&&0<t.length){var i='<option value=""><font><font>请选择</font></font></option>';t.forEach(function(e,t){i+='<option value="'+e.id+'"><font><font>'+e.name+"</font></font></option>"}),$("#companyName").html(i)}}})}function fn_sess_remove(e){sessionStorage.removeItem(e)}function fn_table_loading(){var e="<tr><td colspan="+$("#example-2 thead tr").eq(0).find("th").length+' style="text-align:center">查询中…</td></tr>';$("#table").html(e)}function fn_loading(){var e=this;e.elem=!1,e.show=function(){e.elem&&e.elem.html('<div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>')},e.hide=function(){$(".spinner").remove()}}var objLoading=new fn_loading;function fn_size_window(e,t){var i=$(".navBar").width();$("#container").width(i);var n=$(window).height()-100;if($("#container").height(n),e){t||(t=0);var s=e.height()+t;(n=$(window).height()-100)<s&&(n=s),$("#container").height(n)}}function form_table(){for(var e=!0,t=$(".urequired"),i=t.length,n=0;n<i;n++)if(!t.eq(n).val())return toastr.error(t.eq(n).attr("d-error")),void(e=!1);var s=$(".urequired-sel"),l=s.length;for(n=0;n<l;n++)if(!s.eq(n).find(".tselect-title").attr("d-val"))return toastr.error(s.eq(n).attr("d-error")),void(e=!1);return e}function fn_date(e,t){return t||(t=0),new Date(e).getDate()+t}function daysMath(e){e.days||(e.days=3);var t=format_date({dd:e.start,days:3}),i=e.end;return console.log(t),console.log(i),!(t<i)||(toastr.info("请选择3天内的时间段查询"),objLoading.hide(),!1)}function msgAlert(n){var s=this,l={info:"",title:"提示信息",num:2,txt1:"取消",txt2:"确定"};!function(){for(var e in n||"object"==typeof n||(n=l),l)n.hasOwnProperty(e)||(n[e]=l[e]);if(void 0===n.info||"string"==typeof n.info&&0===n.info.trim().length)console.log("传入值为空");else{var t="";switch(n.num){case 1:t='<div class="msg-footer zoom"><button class="msg-btn msg-btn-ok" id="msg_ok">'+n.txt2+"</button></div>";break;case 2:t='<div class="msg-footer zoom"><button class="msg-btn msg-btn-ok" id="msg_ok">'+n.txt2+'</button><button class="msg-btn msg-btn-cancel" id="msg_cancel">'+n.txt1+"</button></div>"}$("body").append('<div id="msg"></div>');var i='<div class="msg"><div class="msg-header zoom"><a class="msg-close" id="msg_close">×</a><div class="msg-title">'+n.title+'</div></div><div class="msg-body" style="color:#000">'+n.info+"</div>"+t+'</div><div class="msg-bg"></div>';$("#msg").html(i),s.on("btnOkClick"),s.on("btnCancelClick"),$("#msg").off("click","#msg_ok").on("click","#msg_ok",function(e){s.btnOkClick()}),$("#msg").off("click","#msg_close").on("click","#msg_close",function(e){s.hide()}),$("#msg").off("click","#msg_cancel").on("click","#msg_cancel",function(e){s.btnCancelClick()})}}()}function fn_page(i){_this=this;var e={elem:"pageDemo",pages:10,pageNo:1,set:{},fn:function(){}};for(var t in i&&void 0!==i||(i=e),e)i.hasOwnProperty(t)||(i[t]=e[t]);layui.use(["laypage"],function(){(0,layui.laypage)({cont:i.elem,pages:i.pages,curr:i.set.page,skin:"#44bae0",jump:function(e,t){t||(i.set.page=e.curr,i.fn(i.set))}})})}function fn_msg123(){layui.use(["layer"],function(){layui.layer.msg("Hello W12121212orld",{offset:"rt",area:"auto"})})}function fn_tselect(e){if(e&&"object"==typeof e){var t={elem:null,type:"default",options:[],selected:"all",selecteds:[],selected_option:!1,result:null,width:"200px",height:"38px"},n=this;for(var i in n.value="",n.code="",n.text="",n.elem=e.elem,n.selecteds=[],n.selecteds_text=[],n.selecteds_obj=[],n.codes=[],t)e.hasOwnProperty(i)||(e[i]=t[i]);n.id=e.id,n.title=e.title?e.title:"",n.required=e.required?'d-error="请选择'+n.title+'" d-type="select" required':"",n.type=e.type,n.selecteds_default=e.selecteds,n.result=e.result;var s="";0<e.options.length&&(e.options.forEach(function(e,t){e.code=e.code?e.code:"","checkbox"===n.type?s+='<li d-val="'+e.val+'" d-code="'+e.code+'"><span class="default">'+e.name+"</span></li>":s+='<li d-val="'+e.val+'" d-code="'+e.code+'">'+e.name+"</li>"}),(e.selected_option||0===e.selected_option)&&(e.selected=e.options[e.selected_option].val));var l='<div class="tselect" tabindex="1"><div class="tselect-title" '+n.required+'><span>请选择</span><i class="arrow_down"></i></div><ul>'+s+"</ul></div>";n.elem.html(l),n.on("change"),n.elem.off("click",".tselect-title").on("click",".tselect-title",function(){$(this).siblings("ul").show()}),n.elem.off("blur",".tselect").on("blur",".tselect",function(){$(this).find("ul").hide()}),n.elem.off("click",".tselect li").on("click",".tselect li",function(){n.elemLi=$(this),n.elemItem=$(this).find("span"),n.change()}),e.selected&&n.selected(e.selected),n.result&&n.result.off("click",".singleResult-close").on("click",".singleResult-close",function(){n.elemLi=null;var t=$(this).attr("d-id"),i=n.elem.find("li");i.each(function(e){i.eq(e+1).attr("d-val")==t&&i.eq(e+1).find("span").attr("class","default")}),n.selecteds_default=n.selecteds.removeByValue(t),n.selected(e.selected)})}}function fn_ttable(e){if(e&&"object"==typeof e){var t={elem:null,titles:[],items:[]},i=this;for(var n in i.elem=e.elem,i.titles=e.titles,i.items=e.items,t)e.hasOwnProperty(n)||(e[n]=t[n]);i.init(),i.checked=function(){var i=[];return $(".dcheckbox input[type='checkbox']").each(function(e,t){t.checked&&i.push(t.getAttribute("id"))}),i}}}function infoAlert(n){var s=this,e={elem:null,type:"default",title:"",style:"default",items:[],items_new:[]};for(var t in s.value=[],s.selected_obj=[],n||"object"==typeof n||(n=e),e)n.hasOwnProperty(t)||(n[t]=e[t]);s.config=n,s.config.items_new=objDeepCopy(s.config.items);var l="";"search"===n.type&&(l='<div class="selectEvent-search zoom" style="display:none;"><div class="selectEvent-search-text"><input type="text" id="selectEvent_search" placeholder="请输入车牌号码" /></div><div class="selectEvent-search-clear"></div></div>');var a=(s.config=n).items,i=function(){var e='<div class="tselect-title" id="infoAlert_title" d-disabled="true"><span>请选择</span><i class="arrow_down"></i></div>';"white"===s.config.style&&(e='<div class="ctrlBlock-item-selectTitle" id="infoAlert_title" d-disabled="true"><span>请选择</span></div>');return e}();n.elem.html(i),a&&0!==a.length&&(s.on("save"),n.elem.find("#infoAlert_title").off("click").on("click",function(){if("true"===$(this).attr("d-disabled")){$(this).attr("d-disabled","false");var e,t=(e=l,'<div class="infoAlert"><div class="infoAlert-main"><div class="infoAlert-title zoom"><div class="infoAlert-title-txt">'+n.title+'</div><div class="infoAlert-title-close ibtn-close"></div></div><div class="infoAlert-content">'+e+'<div class="selectEvent"></div><div class="selectEvent-btn"><button id="selectEvent_save">保存</button></div></div></div></div><div class="infoAlert-bg"></div>');n.elem.append(t),0<s.config.items.length&&(a=s.config.items);var i=s.fn_list(n.type,a);s.fn_begin(i)}}),n.elem.off("click",".ibtn-close").on("click",".ibtn-close",function(){s.remove(),$(document).find("#infoAlert_title").attr("d-disabled","true"),n.elem.find("#infoAlert_title").attr("d-disabled","true")}),n.elem.off("click",".selectEvent-item").on("click",".selectEvent-item",function(){var e=$(this),t=JSON.parse(e.attr("d-is"));t.isChecked?(t.isChecked=!1,e.attr("d-is",JSON.stringify(t)),e.find(".selectEvent-icon").removeClass("onlineImg").addClass("defaultImg"),t.type?s.selected_click({type:t.type,id:t.id,isChecked:!1}):s.selected_click({id:t.id,isChecked:!1})):(t.isChecked=!0,e.attr("d-is",JSON.stringify(t)),e.find(".selectEvent-icon").removeClass("defaultImg").addClass("onlineImg"),t.type?s.selected_click({type:t.type,id:t.id,isChecked:!0}):s.selected_click({id:t.id,isChecked:!0}))}),n.elem.off("click",".selectEvent-all").on("click",".selectEvent-all",function(){var e=$(this).attr("d-index");if("true"===$(this).attr("d-is")){var t={elem:$(this).parent().next(".selectEvent-box"),is:!1,index:e};s.set_selected(t),$(this).attr("d-is","false"),$(this).find(".selectEvent-icon").removeClass("onlineImg").addClass("defaultImg")}else{t={elem:$(this).parent().next(".selectEvent-box"),is:!0,index:e};s.set_selected(t),$(this).attr("d-is","true"),$(this).find(".selectEvent-icon").removeClass("defaultImg").addClass("onlineImg")}}),n.elem.off("click","#selectEvent_save").on("click","#selectEvent_save",function(){s.config.items=objDeepCopy(s.config.items_new),s.save(),n.elem.find("#infoAlert_title").attr("d-disabled","true")}),n.elem.off("keyup","#selectEvent_search").on("keyup","#selectEvent_search",function(e){13==e.keyCode&&s.fn_blur($(this))}),n.elem.off("click",".selectEvent-search-clear").on("click",".selectEvent-search-clear",function(){n.elem.find("#selectEvent_search").val(""),s.fn_blur(n.elem.find("#selectEvent_search"))}))}function imgAlert(e){var t={index:0,items:[],navigation:!0,isDownload:!0};for(var i in e||"object"==typeof e||(e=t),t)e.hasOwnProperty(i)||(e[i]=t[i]);var s,l=e.index,n=(s="",e.items.forEach(function(e,t){var i=e.infos,n="";0<i.length&&i.forEach(function(e,t){n+="<span>"+e+"</span>"}),s+='<div class="swiper-slide"><div class="imgAlert-img"><img src='+e.src+' /></div><div class="imgAlert-box"><div style="position:relative;"><div class="imgAlert-info-bg"></div><div class="imgAlert-info">'+n+'</div><div class="imgAlert-download" id="download">下载</div></div></div></div>',e.index===l&&(l=t)}),'<div class="imgAlert"><div class="imgAlert-main bounceIn animated"><div class="imgAlert-close"></div><div id="imgAlert_swiper"><div class="swiper-wrapper">'+s+'</div></div><div class="imgAlert-arrow-next"></div><div class="imgAlert-arrow-prev"></div></div><div class="imgAlert-bg"></div></div>');$("body").append(n),e.isDownload||$(".imgAlert-download").remove(),$(document).off("click",".imgAlert-close").on("click",".imgAlert-close",function(){$(".imgAlert").remove()}),$(document).off("click",".imgAlert-download").on("click",".imgAlert-download",function(){!function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","");var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!0,!1,0,null),t.dispatchEvent(i)}($(this).parent().parent().siblings(".imgAlert-img").find("img").attr("src"))}),e.navigation?($(".imgAlert-arrow-next,.imgAlert-arrow-prev").show(),new Swiper("#imgAlert_swiper",{navigation:{nextEl:".imgAlert-arrow-prev",prevEl:".imgAlert-arrow-next"},initialSlide:l})):$(".imgAlert-arrow-next,.imgAlert-arrow-prev").hide()}function singleMenu(e){var i=this,t={elem:null,items:[{name:"",id:"",type:"",val:"",placeholder:"",width:"170",required:!1}]};for(var n in e||"object"==typeof e||(e=t),t)e.hasOwnProperty(n)||(e[n]=t[n]);var s="";e.items.forEach(function(e,t){switch(e.type){case"text":s+=i.re_text(e);break;case"btn":s+=i.re_btn(e);break;case"select":s+=i.re_select(e);break;case"date":s+=i.re_date(e);break;default:s+=i.re_text(e)}}),e.elem.html(s)}function singleTab(n){var e={elem:null,options:[],default:0};for(var t in n||"object"==typeof n||(n=e),e)n.hasOwnProperty(t)||(n[t]=e[t]);var s="";n.options.forEach(function(e,t){var i=n.default===t?"online":"default";s+='<div class="singleTab-span '+i+'" d-index="'+t+'">'+e.name+"</div>"}),n.elem.html(s),n.elem.off("click",".singleTab-span").on("click",".singleTab-span",function(){$(".singleTab-span").removeClass("online").addClass("default"),$(this).removeClass("default").addClass("online")})}function fn_edit_begin(d){var c=this,e={elem:null,items:[]};for(var t in e)d.hasOwnProperty(t)||(d[t]=e[t]);var o=d.items;this.width_content=0,this.sel_arr=[];for(var i="",n=0;n<o.length;n++){var s="";if(o[n].items&&0<o[n].items.length)o[n].items.forEach(function(e,t){c.width_content=0,2==e.colspan?c.width_content="calc(50% - 15px)":3==e.colspan?c.width_content="calc(75% - 8px)":4==e.colspan&&(c.width_content="100%"),s+=c.re_html(e)});i+='<div class="mngCar-block"><div class="mngCar-block-title"><span>'+o[n].title+'</span></div><div class="mngCar-block-content zoom">'+s+"</div></div>"}function l(l,a,s){var o="";$.ajax({url:"https://performance.whome.cn/get_token",type:"get",dataType:"json",data:{file_name:name}}).then(function(e){"0000"===e.code&&(e=e.data,o=e.pre_url,function(e){qiniu.region.z0;var t=document.querySelectorAll("[type=file]");if(!(t=t[s]))return;var i=new FormData;i.append("file",t.files[0]),i.append("key",e.key),i.append("token",e.token),n=i,$.ajax({url:"https://upload.qiniup.com",type:"post",dataType:"json",data:n,cache:!1,processData:!1,contentType:!1}).then(function(e){console.log(e);var t=o;if(l.hide(),l.find("button").html("上传照片"),"default"===a)l.siblings(".mngCar-photo-img").show(),l.siblings(".mngCar-photo-img").find("img").attr("src",t+e.key);else{l.siblings(".mngCar-photo-img").show(),l.siblings(".mngCar-photo-img").find("img").attr("src",t+e.key);var i=l.parent().parent().attr("d-num"),n=d.elem.find(".mngCar-photo-add").length;if(i<=n)return;var s=c.re_html_photo({id:""});l.parent().after(s)}});var n}({token:e.token,key:e.access_key}))})}d.elem.html(i),$(".mngCar-select").each(function(e,t){for(var i=$(".mngCar-select").eq(e).attr("id"),n=0;n<o.length;n++)for(var s=o[n].items,l=0;l<s.length;l++)if(i==s[l].id){var a=s[l].selected?s[l].selected:"";return void(c.sel_arr[e]=new fn_tselect({elem:$("#"+s[l].id),options:s[l].options,id:s[l].id,selected:a,required:s[l].required,title:s[l].title.substring(0,s[l].title.length-1)}))}i=$(".mngCar-select").eq(e).attr("id"),$(".mngCar-select").eq(e).attr("d-required")}),d.elem.off("change",".file-fixed").on("change",".file-fixed",function(){$(this).siblings("button").html("上传中"),l($(this).parent(),"default",$(this).parents(".mngCar-item").index())}),d.elem.off("click",".mngCar-photo-remove").on("click",".mngCar-photo-remove",function(){$(this).parent().hide(),$(this).parent().siblings(".mngCar-photo-add,.mngCar-photo-default").show(),$(this).siblings("img").attr("src","")}),d.elem.off("change",".mngCar-photo-add input[type=file]").on("change",".mngCar-photo-add input[type=file]",function(){$(this).siblings("button").html("上传中"),l($(this).parent(),"add",$(this).parent().parent().index())}),d.elem.off("click",".mngCar-photo-removeAdd").on("click",".mngCar-photo-removeAdd",function(){$(this).parent().hide(),$(this).parent().siblings(".mngCar-photo-default").show()})}function fn_format_arr(e){return e.forEach(function(e,t){for(var i in e)e[i]||(e[i]="--")}),e}function format_date(e){var t={fmt:"yyyy-MM-dd hh:mm:ss",dd:!1,days:0};for(var i in"object"!=typeof e&&(e=t),t)e.hasOwnProperty(i)||(e[i]=t[i]);var n=e.dd;n?n="now"===n?new Date:new Date(n.replace(/-/g,"/")):(n=(n=new Date).format("yyyy/MM/dd")+" 00:00:00",n=new Date(n));var s=n.getTime(),l=e.days;l||(l=0);var a=864e5*l;return n.setTime(s+a),n.format()}function compare(s,l){return l||(l="low"),function(e,t){var i=e[s],n=t[s];return"low"===l?(i="--"===i?99999999:i)-(n="--"===n?99999999:n):(n="--"===n?0:n)-(i="--"===i?0:i)}}function GetQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!=i?unescape(i[2]):null}msgAlert.prototype={on:function(e,t,i){this[e]=function(){0!=i&&this.hide(),"function"==typeof t&&t.apply(this)}},hide:function(){$("#msg").remove()}},fn_tselect.prototype.on=function(e,t){var i=this;this[e]=function(){"change"===e&&i.dftchange(),"function"==typeof t&&t.apply(this)}},fn_tselect.prototype.dftchange=function(){var o,t,i,e,n,d=this,s=d.elemLi;s?function(){o=s.attr("d-val"),t=s.attr("d-code"),"checkbox"===d.type?function(){"default"===d.elemItem.attr("class")?d.elemItem.attr("class","active"):d.elemItem.attr("class","default");if("all"===o)if(d.selecteds=[],d.selecteds_text=[],d.selecteds_obj=[],d.codes=[],"active"===d.elemItem.attr("class")){var l=d.elem.find("li");l.each(function(e,t){if(0!=e){l.eq(e).find("span").attr("class","active");var i=l.eq(e).attr("d-val");d.selecteds.push(i);var n=l.eq(e).find("span").html();d.selecteds_text.push(n);var s=l.eq(e).attr("d-code");d.codes.push('"'+s+'"'),d.selecteds_obj.push({val:i,text:n})}})}else d.elem.find("li").find("span").attr("class","default");else{var e=d.elemItem.html();"active"===d.elemItem.attr("class")?(d.selecteds.push(o),d.selecteds_text.push(e),d.codes.push('"'+t+'"'),d.selecteds_obj.push({val:o,text:e})):(d.selecteds.removeByValue(o),d.selecteds_text.removeByValue(e),d.codes.removeByValue('"'+t+'"'),d.selecteds_obj.removeByValue({val:o,text:e}))}i="已选择："+d.selecteds.length}():(i=s.html(),s.parent().parent().blur());s.parent().siblings(".tselect-title").attr("d-val",o),s.parent().siblings(".tselect-title").attr("d-code",t),s.parent().siblings(".tselect-title").find("span").html(i),d.value=o,d.code=t,d.text=i}():function(){s=d.elem.find(".tselect-title"),d.selecteds_default?(o=d.selecteds_default).forEach(function(e,t){"all"==e&&(o="all")}):o=d.value;if(t=d.code,i=d.text,d.selecteds=[],d.selecteds_text=[],d.selecteds_obj=[],d.codes=[],"checkbox"===d.type){var a=d.elem.find("li");"all"===o?a.each(function(e,t){a.eq(e).find("span").attr("class","active");var i=a.eq(e).attr("d-val");if(0!==e){d.selecteds.push(i);var n=a.eq(e).find("span").html();d.selecteds_text.push(n);var s=a.eq(e).attr("d-code");d.codes.push('"'+s+'"'),d.selecteds_obj.push({val:i,text:n})}}):"object"==typeof o?o.forEach(function(l,e){a.each(function(e,t){var i=a.eq(e).attr("d-val");if(i==l){a.eq(e).find("span").attr("class","active"),d.selecteds.push(i);var n=a.eq(e).find("span").html();d.selecteds_text.push(n);var s=a.eq(e).attr("d-code");d.codes.push('"'+s+'"'),d.selecteds_obj.push({val:i,text:n})}})}):a.each(function(e,t){var i=a.eq(e).attr("d-val");if(i===o){a.eq(e).find("span").attr("class","active"),d.selecteds.push(i);var n=a.eq(e).find("span").html();d.selecteds_text.push(n);var s=a.eq(e).attr("d-code");d.codes.push('"'+s+'"'),d.selecteds_obj.push({val:i,text:n})}}),i="已选择："+d.selecteds.length}else s.parent().blur();s.attr("d-val",o),s.attr("d-code",t),s.find("span").html(i)}(),e=d.elem.find("li"),n=e.length-1,d.selecteds.length===n?e.eq(0).find("span").attr("class","active"):e.eq(0).find("span").attr("class","default"),function(){if(d.result){var i="";d.selecteds_obj.forEach(function(e,t){i+='<li class="zoom"><div class="singleResult-title">'+e.text+'</div><div class="singleResult-close" d-id="'+e.val+'"></div></li>'}),d.result.html('<div class="singleResult"><ul class="zoom">'+i+"</ul></div>")}}()},fn_tselect.prototype.selected=function(e){var t=this.elem,i=t.find('.tselect li[d-val="'+e+'"]')||[];if(0!==i.length){var n=i.attr("d-val"),s=i.attr("d-code"),l=i.text();t.find(".tselect-title").attr("d-val",n),t.find(".tselect-title").attr("d-code",s),t.find(".tselect-title").find("span").html(l),this.value=n,this.code=s,this.text=l}else console.log("没有找到相关选项")},fn_ttable.prototype.initTitle=function(e){e&&(this.titles=e);var t="";return 0<this.titles.length&&this.titles.forEach(function(e){t+="checkbox"===e?'<th style="width:50px"><div class="dcheckbox-all"><input type="checkbox" id="all"><label for="all" class="default"></label></div></th>':"<th>"+e+"</th>"}),t="<tr>"+t+"</tr>"},fn_ttable.prototype.initItems=function(e){e&&(this.items=e);var t=this.titles.length,i="";return"string"==typeof e?i="<tr><td colspan="+t+">"+e+"</td></tr>":0<this.items.length?this.items.forEach(function(e){var t="";e.tds.forEach(function(e){t+="<td>"+e+"</td>"}),i+="<tr>"+t+"</tr>"}):i="<tr><td colspan="+t+">没有找到相关数据</td></tr>",i},fn_ttable.prototype.init=function(e){var t=!1,i="请选择条件查询";"object"==typeof e&&(t=e.titles?e.titles:t,i=e.items?e.items:i);var n=this.initTitle(t),s=this.initItems(i);this.elem.html(n+s)},$(document).off("click",".dcheckbox").on("click",".dcheckbox",function(){var e=$(this).find("input"),t=$(this).find("label");e.is(":checked")?t.attr("class","active"):t.attr("class","default")}),$(document).off("click",".dcheckbox-all").on("click",".dcheckbox-all",function(){var e=$(this).find("input"),t=$(this).find("label");e.is(":checked")?(t.attr("class","active"),$(".dcheckbox input[type='checkbox']").each(function(e,t){t.checked=!0,$(this).siblings("label").attr("class","active")})):(t.attr("class","default"),$(".dcheckbox input[type='checkbox']").each(function(e,t){t.checked=!1,$(this).siblings("label").attr("class","default")}))}),infoAlert.prototype={on:function(e,t,i){this[e]=function(){0!=i&&(this.selecteds(),this.remove()),"function"==typeof t&&t.apply(this)}},set_selected:function(n){this.config.items_new[n.index].items.forEach(function(e,t){e.isChecked=n.is;var i={isChecked:n.is,type:t+1,id:e.id};n.elem.find(".selectEvent-item").eq(t).attr("d-is",JSON.stringify(i)),n.is?n.elem.find(".selectEvent-item").eq(t).find(".selectEvent-icon").removeClass("defaultImg").addClass("onlineImg"):n.elem.find(".selectEvent-item").eq(t).find(".selectEvent-icon").removeClass("onlineImg").addClass("defaultImg")})},selecteds:function(){var i,n,s,l,e,t=this,a=t.config.items_new,o=$(".selectEvent-item"),d=[];0<o.length&&"default"===t.config.type?(l=[],(s=o).each(function(e,t){var i=JSON.parse(s.eq(e).attr("d-is"));i.isChecked&&l.push(i.id)}),e=l,$.ajax({url:ajax_106+"/save_user_vehicle_exception",type:"post",dataType:"json",data:{user_id:info_login.data.id,option:JSON.stringify(e)}}).then(function(e){e.code}),d=l):"default"===t.config.type?(n=[],a.forEach(function(e,t){for(var i=0;i<e.items.length;i++)e.items[i].isChecked&&n.push(e.items[i].id)}),d=n):"search"===t.config.type&&(i=[],a.forEach(function(e,t){e.isChecked&&i.push(e.id)}),d=i),t.value=d;var c=t.value.length;t.config.elem.find("span").html("已选择："+c)},selected_click:function(n){var e=this.config.items_new;n.type?e.forEach(function(e,t){for(var i=0;i<e.items.length;i++)n.id===e.items[i].id&&(e.items[i].isChecked=n.isChecked)}):e.forEach(function(e,t){n.id===e.id&&(e.isChecked=n.isChecked)})},fn_blur:function(i){var n=[],e=this.config.items;e.forEach(function(e,t){-1<e.txt.indexOf(i.val())&&n.push(e)}),console.log(e);var t=this.fn_list(this.config.type,n);this.fn_begin(t)},fn_list:function(e,t){var n,i=[];return"default"===e?i=function(e){t=e,a=[],t.forEach(function(e,t){a.push([]);for(var i=e.items,n=[],s=[],l=0;l<i.length;l++)s.push(i[l]),4==s.length?(n.push(s),s=[]):l==i.length-1&&(n.push(s),s=[]);a[t]={title:e.title,type:e.type,items:n}}),e=a;var t,a;var v="";return e.forEach(function(e,t){var i=function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++)if(!e[t][i].isChecked)return!1;return!0}(e.items),n=i?"onlineImg":"defaultImg",s="";e.title&&(s='<div class="selectEvent-title zoom"><span>'+e.title+'</span><div class="selectEvent-all" d-is="'+i+'" d-index="'+t+'"><div class="selectEvent-icon '+n+'"></div><div class="selectEvent-txt">全选</div></div></div>');for(var l="",a=e.items,o=0;o<a.length;o++){for(var d="",c=0;c<a[o].length;c++){var r=a[o][c].isChecked;r=a[o][c].isChecked?"onlineImg":"defaultImg";var f={isChecked:a[o][c].isChecked,type:e.type,id:a[o][c].id};d+='<div class="selectEvent-item zoom" d-is=\''+JSON.stringify(f)+"'><div class=\"selectEvent-icon "+r+'"></div><div class="selectEvent-txt">'+a[o][c].txt+"</div></div>"}l+='<div class="selectEvent-line zoom">'+d+"</div>"}v+=s+'<div class="selectEvent-box">'+l+"</div>"}),v}(t):(n="",t.forEach(function(e,t){e.items,e.isChecked?isChecked="onlineImg":isChecked="defaultImg";var i={isChecked:e.isChecked,id:e.id};n+='<div class="selectEvent-item zoom" d-is=\''+JSON.stringify(i)+"'><div class=\"selectEvent-icon "+isChecked+'"></div><div class="selectEvent-txt">'+e.txt+"</div></div>"}),i='<div class="selectEvent-box zoom">'+n+"</div>"),i},fn_begin:function(e){$(".selectEvent").html(e);var t=$(".infoAlert").width(),i=$(".infoAlert").height();$(".infoAlert").css("margin-top",-i/2),$(".infoAlert").css("margin-left",-t/2)},remove:function(){$(".infoAlert,.infoAlert-bg").remove()}},singleMenu.prototype={re_text:function(e){return e.width=e.width?e.width:"170",e.placeholder=e.placeholder?e.placeholder:"",'<div class="singleMenu-item zoom"><div class="singleMenu-item-txt">'+e.name+'</div><div class="singleMenu-item-content" style="width:'+e.width+'px;"><input type="text" class="dtext" placeholder="'+e.placeholder+'" id="'+e.id+'" /></div></div>'},re_btn:function(e){return'<div class="singleMenu-item"><button class="dbtn" id="'+e.id+'">'+e.name+"</button></div>"},re_select:function(e){return e.width=e.width?e.width:"170",'<div class="singleMenu-item zoom"><div class="singleMenu-item-txt">'+e.name+'</div><div class="singleMenu-item-content" id="'+e.id+'" style="width:'+e.width+'px;"></div></div>'},re_date:function(e){e.width=e.width?e.width:"170",e.placeholder=e.placeholder?e.placeholder:"";var t="laydate.render({elem:this,type:'datetime',position:'fixed',btns:['clear', 'confirm'],format:'yyyy-MM-dd HH:mm:ss',theme:'#44bae0',show:true,trigger:'click',max:1});",i=e.boxId?e.boxId:"";return"end"==e.typeStyle&&(t="laydate.render({elem:this,type:'datetime',position:'fixed',format:'yyyy-MM-dd HH:mm:ss',theme:'#44bae0',show:true,trigger:'click',max:1});"),'<div class="singleMenu-item zoom" id="'+i+'"><div class="singleMenu-item-txt">'+e.name+'</div><div class="singleMenu-item-content" style="width:'+e.width+'px;"><input type="text" class="dtext" placeholder="'+e.placeholder+'" id="'+e.id+'" onclick="'+t+'" /></div></div>'}},fn_edit_begin.prototype={re_html:function(e){var s=this,i=e.required?"<span>*</span>":"",l="";s.width_content&&(l='style="width:'+this.width_content+';margin-right:0;"');var t,n,a,o,d,c,r,f,v,m,h,u,p,g,y,b,w,x,_,k="";switch(e.type){case"select":k='<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+(_=e).title+'</div><div class="mngCar-item-content mngCar-select" id="'+_.id+'" d-required="'+_.required+'"></div></div>';break;case"date":b=(y=e).value?'value="'+y.value+'"':"",w=y.required?'d-error="请输入'+y.title.substring(0,y.title.length-1)+'" required':"",x=y.max?",max:"+y.max:"",k='<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+y.title+"</div><div class=\"mngCar-item-content\"><input type=\"text\" class=\"dtext mngCar-item-text icon-date\" onclick=\"laydate.render({elem:this,type:'datetime',position:'fixed',format:'yyyy-MM-dd HH:mm:ss',theme:'#44bae0',show:true,trigger:'click'"+x+'});" id="'+y.id+'" '+w+" "+b+' maxlength="50" d-type="date" /></div></div>';break;case"dateStartEnd":v=(f=e).value1?'value="'+f.value1+'"':"",m=f.value2?'value="'+f.value2+'"':"",h=f.required1?'d-error="请输入'+f.placeholder1+'" required':"",u=f.required2?'d-error="请输入'+f.placeholder2+'" required':"",p=f.max1?",max:"+f.max1:"",g=f.max2?",max:"+f.max2:"",k='<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+f.title+"</div><div class=\"mngCar-item-content\"><input type=\"text\" class=\"dtext mngCar-item-text icon-date\" onclick=\"laydate.render({elem:this,type:'datetime',position:'fixed',format:'yyyy-MM-dd HH:mm:ss',theme:'#44bae0',show:true,trigger:'click'"+p+'});" placeholder="'+f.placeholder1+'" id="'+f.id1+'" '+v+' style="width:170px;" '+h+' maxlength="50" d-type="date" /><span style="color:#fff;margin:0 10px;">——</span><input type="text" class="dtext mngCar-item-text icon-date" onclick="laydate.render({elem:this,type:\'datetime\',position:\'fixed\',format:\'yyyy-MM-dd HH:mm:ss\',theme:\'#44bae0\',show:true,trigger:\'click\''+g+'});" placeholder="'+f.placeholder2+'" id="'+f.id2+'" '+m+' style="width:170px;" '+u+' maxlength="50" d-type="date" /></div></div>';break;case"textarea":c=(d=e).value?d.value:"",r=d.required?'d-error="请输入'+d.title.substring(0,d.title.length-1)+'" required':"",k='<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+d.title+'</div><div class="mngCar-item-content"><textarea class="dtext mngCar-item-texteara" id="'+d.id+'" '+r+' maxlength="50">'+c+"</textarea></div></div>";break;case"upload":k=function(e){var n=s.re_html_photo(e);if(console.log(e.srcs),e.srcs){n="";var t=JSON.parse(e.srcs);t.forEach(function(e,t){var i={id:t,src:e};n+=s.re_html_photo(i)}),t.length<3&&(n+=s.re_html_photo(e))}return e.num=e.num?e.num:3,'<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+e.title+'</div><div class="mngCar-item-content zoom" d-num="'+e.num+'">'+n+"</div></div>"}(e);break;case"upload_fixed":l='style="width:33.3%;margin-right:0;"',k=function(e){var t='<div class="mngCar-photo-default"><img src="img/mng/car/add.png" /><br><button>上传照片</button><input type="file" class="file-fixed" /></div><div class="mngCar-photo-img" style="display:none;"><img src="" alt="" id="'+e.id+'" /><div class="mngCar-photo-remove"></div></div>';e.src&&(t='<div class="mngCar-photo-default" style="display:none;"><img src="img/mng/car/add.png" /><br><button>上传照片</button><input type="file" class="file-fixed" /></div><div class="mngCar-photo-img"><img src="'+e.src+'" alt="" id="'+e.id+'" /><div class="mngCar-photo-remove"></div></div>');return'<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+e.title+'</div><div class="mngCar-item-content zoom"><div class="mngCar-photo dtext">'+t+"</div></div></div>"}(e);break;default:n=(t=e).value?"value="+t.value:"",a=t.disabled?'disabled="disabled"':"",o=t.required?'d-error="请输入'+t.title.substring(0,t.title.length-1)+'" required':"",k='<div class="mngCar-item zoom" '+l+'><div class="mngCar-item-title">'+i+t.title+'</div><div class="mngCar-item-content"><input type="text" class="dtext mngCar-item-text" d-type="text" id="'+t.id+'" '+o+" "+n+' maxlength="50" '+a+" /></div></div>"}return k},re_html_photo:function(e){var t='<div class="mngCar-photo-add"><img src="img/mng/car/add.png" /><br><button>上传照片</button><input type="file" class="file-fixed" /></div><div class="mngCar-photo-img" style="display:none;"><img src="" alt="" id="'+e.id+'" /><div class="mngCar-photo-remove mngCar-photo-removeAdd"></div></div>';return e.src&&(t='<div class="mngCar-photo-add" style="display:none;"><img src="img/mng/car/add.png" /><br><button>上传照片</button><input type="file" class="file-default" /></div><div class="mngCar-photo-img"><img src="'+e.src+'" alt="" id="'+e.id+'" /><div class="mngCar-photo-remove mngCar-photo-removeAdd"></div></div>'),'<div class="mngCar-photo dtext">'+t+"</div>"},is_required:function(){for(var e=$("[required]"),t=0;t<e.length;t++){var i=e.eq(t),n=i.attr("d-type");if(n&&"text"==n){if(!i.val()){var s=i.attr("d-error");return toastr.error(s),!1}}else if("select"==n){if(!i.attr("d-val")){s=i.attr("d-error");return toastr.error(s),!1}}else if("date"==n){if(!i.val()){s=i.attr("d-error");return toastr.error(s),!1}}}return!0}},Date.prototype.format=function(e){e||(e="yyyy-MM-dd hh:mm:ss");var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var objDeepCopy=function(e){var t=e instanceof Array?[]:{};for(var i in e)t[i]="object"==typeof e[i]?objDeepCopy(e[i]):e[i];return t};function ret_infoWindow(e){var t={title:"标题",type:"default",items:[],btns:[],width:70,imgSrc:""};for(var i in e||"object"==typeof e||(e=t),t)e.hasOwnProperty(i)||(e[i]=t[i]);this.config=e;var n='<div class="infoWindowNew-title zoom"><div class="infoWindowNew-title-txt">'+e.title+'</div><div class="infoWindowNew-title-close ibtn-close"></div></div>',s="";s="video"===e.type?function(e){var i="";0<e.length&&(e.forEach(function(e,t){i+='<div class="infoWindow-item zoom"><div class="infoWindow-item-title" style="width:'+this.config.width+'px">'+e.title+'</div><div class="infoWindow-item-content" style="width:calc(100% - '+this.config.width+'px);">'+e.content+"</div></div>"}),i='<div class="infoWindow-box">'+i+'</div><div class="infoWindow-img"><div class="infoWindow-view"><video id="infoWindow_video" width="107" height="80"><source src="'+this.config.info.video_url_view+'" type="video/mp4"></video></div><div class="infoWindow-img-operation infoWindow-img-play"></div><div class="infoWindow-img-timg"></div><div class="infoWindow-smallView"><video id="infoWindow_video_small" width="40" height="30"><source src="'+this.config.info.video_url_small+'" type="video/mp4"></video></div></div>');return'<div class="infoWindowNew-content zoom" style="margin-top:12px;">'+i+"</div>"}(e.items):"img"===e.type&&e.imgSrc&&"--"!==e.imgSrc?function(e){var i="";0<e.length&&(e.forEach(function(e,t){i+='<div class="infoWindow-item zoom"><div class="infoWindow-item-title" style="width:'+this.config.width+'px">'+e.title+'</div><div class="infoWindow-item-content" style="width:calc(100% - '+this.config.width+'px);">'+e.content+"</div></div>"}),i='<div class="infoWindow-box">'+i+'</div><div class="infoWindow-img"><img src="'+this.config.imgSrc+'"/><div class="infoWindow-img-timg" style="display:block;"></div></div>');return'<div class="infoWindowNew-content zoom" style="margin-top:12px;">'+i+"</div>"}(e.items):function(e){var i="";0<e.length&&e.forEach(function(e,t){i+='<div class="infoWindowNew-box zoom"><div class="infoWindowNew-box-title" style="width:'+this.config.width+'px">'+e.title+'</div><div class="infoWindowNew-box-content" style="width:calc(100% - '+this.config.width+'px);">'+e.content+"</div></div>"});return'<div class="infoWindowNew-content">'+i+"</div>"}(e.items);var l=function(e){var n="";0<e.length&&e.forEach(function(e,t){if("object"==typeof e){var i=i="cancel"===e.type?"cbtn-cancel infoWindowNew-btn-cancel":"cbtn";e.id=e.id?e.id:"",e.data=e.data?e.data:"",n+='<button class="'+i+'" id="'+e.id+"\" d-data='"+e.data+"'>"+e.name+"</button>"}else n+='<button class="cbtn">'+e+"</button>"});return'<div class="infoWindowNew-button">'+n+"</div>"}(e.btns);return $(document).off("click",".infoWindowNew-title-close").on("click",".infoWindowNew-title-close",function(){map.clearInfoWindow()}),$(document).off("click",".infoWindowNew-btn-cancel").on("click",".infoWindowNew-btn-cancel",function(){map.clearInfoWindow()}),'<div class="infoWindowNew">'+n+s+l+"</div>"}function map_marker(e){return e.extData||(e.extData={}),e.title||(e.title=""),e.offset||(e.offset=new AMap.Pixel(15,30)),"center"==e.bg?e.offset=new AMap.Pixel(10,25):e.bg||(e.bg="red"),new AMap.Marker({extData:e.extData,icon:"img/lnglat/"+e.bg+".png",label:{content:e.name,offset:e.offset},topWhenClick:!0,topWhenMouseOver:!0,position:e.location,title:e.title,map:map})}Array.prototype.remove_arr=function(e){var t=this.indexOf(e);-1<t&&this.splice(t,1)},Array.prototype.remove_arr=function(e){var t=this.indexOf(e);-1<t&&this.splice(t,1)},Array.prototype.isArrLike=function(){var i=this,n=!1;return i.forEach(function(e,t){t!==i.length&&(JSON.stringify(e)===JSON.stringify(i[t+1])&&(n=!0))}),n},Array.prototype.notempty=function(){for(var e=this,t=0;t<e.length;t++)""!=$.trim(e[t])&&void 0!==e[t]||(e.splice(t,1),t-=1);return e},Array.prototype.removeByValue=function(e){if("object"==typeof e){var i=[];this.forEach(function(e,t){i.push(JSON.stringify(e))});var t=i.indexOf(JSON.stringify(e));return this.splice(t,1),this}for(var n=0;n<this.length;n++)if(this[n]==e){this.splice(n,1);break}return this};